import{r as o,o as i,c,a as e,b as a,w as t,F as p,d as s,e as l}from"./app.3a4a8f90.js";import{_ as r}from"./plugin-vue_export-helper.21dcd24c.js";const d={},u=e("h1",{id:"api-service",tabindex:"-1"},[e("a",{class:"header-anchor",href:"#api-service","aria-hidden":"true"},"#"),s(" API Service")],-1),h=e("p",null,"Primary functionality of the package is to easy the usage of the Heseya API. This can be done by creating an instance of the SDK and calling the methods on it.",-1),k={class:"table-of-contents"},m=s("Initialization"),b=s("Available modules"),y=s("Authorization"),g=s("Login"),f=s("Refresh access token"),v=s("Logout"),A=s("Register new user"),w=s("Check identity token"),_=l(`<h2 id="initialization" tabindex="-1"><a class="header-anchor" href="#initialization" aria-hidden="true">#</a> Initialization</h2><p>You can initialize the API Service by calling the <code>createHeseyaApiService</code> function. It is important to pass the <code>axios</code> instance to the function.</p><div class="custom-container tip"><p class="custom-container-title">TIP</p><p>Axios instance needs to be configured to use the URL of the Heseya API. Without it the SDK will not be able to make requests to the API.</p></div><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">import</span> axios <span class="token keyword">from</span> <span class="token string">&#39;axios&#39;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> createHeseyaApiService<span class="token punctuation">,</span> HeseyaApiService <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;@heseya/store-core&#39;</span>

<span class="token keyword">const</span> axiosInstance <span class="token operator">=</span> axios<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">{</span> baseURL<span class="token operator">:</span> <span class="token string">&#39;https://api.example.com&#39;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token keyword">const</span> heseya<span class="token operator">:</span> HeseyaApiService <span class="token operator">=</span> <span class="token function">createHeseyaApiService</span><span class="token punctuation">(</span>axiosInstance<span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>You can also create the API Service creating own Axios instance. To do this you can use the <code>createHeseyaApiService</code> function with the <code>baseURL</code> parameter containing the URL of the Heseya API.</p><div class="custom-container warning"><p class="custom-container-title">WARNING</p><p>This is not recommended, as it is not possible to influence the Axios instance in any way. Nethertheless, it could be good enough for use cases when you do not need to use, for example, authentication.</p></div><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> createHeseyaApiService<span class="token punctuation">,</span> HeseyaApiService <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;@heseya/store-core&#39;</span>

<span class="token keyword">const</span> heseya<span class="token operator">:</span> HeseyaApiService <span class="token operator">=</span> <span class="token function">createHeseyaApiService</span><span class="token punctuation">(</span><span class="token string">&#39;https://api.example.com&#39;</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>Now, you can use the <code>HeseyaApiService</code> object to call the API for any of the endpoints.</p><p>For example, you can fetch all the products:</p><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">const</span> products <span class="token operator">=</span> <span class="token keyword">await</span> heseya<span class="token punctuation">.</span>Products<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br></div></div><div class="custom-container tip"><p class="custom-container-title">TIP</p><p>All the methods on the <code>HeseyaApiService</code> object return promises. If the request fails, the promise will be rejected with an default <code>AxiosError</code> object. This package provides a helper function to handle that errors <a href="#format-api-errors"><code>formatApiError</code></a>.</p></div><h2 id="available-modules" tabindex="-1"><a class="header-anchor" href="#available-modules" aria-hidden="true">#</a> Available modules</h2><p>The SDK provides a service for each of the available API endpoints. Each module has a typed methods to call the API.</p><ul><li><code>Analytics</code></li><li><code>Apps</code></li><li><code>Auth</code></li><li><code>Banners</code></li><li><code>UserProfile</code></li><li><code>Roles</code></li><li><code>Users</code></li><li><code>Products</code></li><li><code>Schemas</code></li><li><code>Tags</code></li><li><code>ProductSets</code></li><li><code>Warehouse</code></li><li><code>Attributes</code></li><li><code>Pages</code></li><li><code>Sales</code></li><li><code>Coupons</code></li><li><code>Orders</code></li><li><code>OrderStatuses</code></li><li><code>ShippingMethods</code></li><li><code>PackagesTemplates</code></li><li><code>GlobalSeo</code></li><li><code>PaymentMethods</code></li><li><code>Settings</code></li><li><code>Media</code></li><li><code>Webhooks</code></li><li><code>Consents</code></li></ul><h2 id="authorization" tabindex="-1"><a class="header-anchor" href="#authorization" aria-hidden="true">#</a> Authorization</h2><p>The SDK does not provide any authorization. You need to implement your own authorization mechanism. To do this, you should use the <code>axios</code> instance that you injected into the <code>createHeseyaApiService</code> function. That instance needs to have interceptors configured to add the authorization header, as well as to handle the token refreshing.</p><p>There is a helper <a href="#auth-axios-enhancer"><code>enhanceAxiosWithAuthTokenRefreshing</code> function</a> that addes all the necessary authorization headers to the Axios instance.</p><p>To handle auth requests you can use methods from the <code>Auth</code> module.</p><h3 id="login" tabindex="-1"><a class="header-anchor" href="#login" aria-hidden="true">#</a> Login</h3><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">const</span> user <span class="token operator">=</span> <span class="token keyword">await</span> heseya<span class="token punctuation">.</span>Auth<span class="token punctuation">.</span><span class="token function">login</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  email<span class="token operator">:</span> <span class="token string">&#39;admin@example.com&#39;</span><span class="token punctuation">,</span>
  password<span class="token operator">:</span> <span class="token string">&#39;admin&#39;</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h3 id="refresh-access-token" tabindex="-1"><a class="header-anchor" href="#refresh-access-token" aria-hidden="true">#</a> Refresh access token</h3><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token comment">// { user, accessToken, identityToken, refreshToken }</span>
<span class="token keyword">const</span> data <span class="token operator">=</span> <span class="token keyword">await</span> heseya<span class="token punctuation">.</span>Auth<span class="token punctuation">.</span><span class="token function">refreshToken</span><span class="token punctuation">(</span>currentRefreshToken<span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h3 id="logout" tabindex="-1"><a class="header-anchor" href="#logout" aria-hidden="true">#</a> Logout</h3><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">await</span> heseya<span class="token punctuation">.</span>Auth<span class="token punctuation">.</span><span class="token function">logout</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br></div></div><h3 id="register-new-user" tabindex="-1"><a class="header-anchor" href="#register-new-user" aria-hidden="true">#</a> Register new user</h3><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">const</span> user <span class="token operator">=</span> <span class="token keyword">await</span> heseya<span class="token punctuation">.</span>Auth<span class="token punctuation">.</span><span class="token function">register</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  name<span class="token operator">:</span> <span class="token string">&#39;admin&#39;</span><span class="token punctuation">,</span>
  email<span class="token operator">:</span> <span class="token string">&#39;admin@example.com&#39;</span><span class="token punctuation">,</span>
  password<span class="token operator">:</span> <span class="token string">&#39;admin&#39;</span><span class="token punctuation">,</span>
  consents<span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h3 id="check-identity-token" tabindex="-1"><a class="header-anchor" href="#check-identity-token" aria-hidden="true">#</a> Check identity token</h3><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">const</span> user <span class="token operator">=</span> <span class="token keyword">await</span> heseya<span class="token punctuation">.</span>Auth<span class="token punctuation">.</span><span class="token function">checkIdentity</span><span class="token punctuation">(</span>identityToken<span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br></div></div>`,28);function x(S,T){const n=o("RouterLink");return i(),c(p,null,[u,h,e("nav",k,[e("ul",null,[e("li",null,[a(n,{to:"#initialization"},{default:t(()=>[m]),_:1})]),e("li",null,[a(n,{to:"#available-modules"},{default:t(()=>[b]),_:1})]),e("li",null,[a(n,{to:"#authorization"},{default:t(()=>[y]),_:1}),e("ul",null,[e("li",null,[a(n,{to:"#login"},{default:t(()=>[g]),_:1})]),e("li",null,[a(n,{to:"#refresh-access-token"},{default:t(()=>[f]),_:1})]),e("li",null,[a(n,{to:"#logout"},{default:t(()=>[v]),_:1})]),e("li",null,[a(n,{to:"#register-new-user"},{default:t(()=>[A]),_:1})]),e("li",null,[a(n,{to:"#check-identity-token"},{default:t(()=>[w]),_:1})])])])])]),_],64)}var H=r(d,[["render",x]]);export{H as default};
